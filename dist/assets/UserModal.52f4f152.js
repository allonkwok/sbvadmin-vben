var M=Object.defineProperty,P=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var y=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var b=(o,t,e)=>t in o?M(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,m=(o,t)=>{for(var e in t||(t={}))y.call(t,e)&&b(o,e,t[e]);if(B)for(var e of B(t))C.call(t,e)&&b(o,e,t[e]);return o},F=(o,t)=>P(o,_(t));var g=(o,t,e)=>new Promise((l,i)=>{var p=u=>{try{n(e.next(u))}catch(c){i(c)}},d=u=>{try{n(e.throw(u))}catch(c){i(c)}},n=u=>u.done?l(u.value):Promise.resolve(u.value).then(p,d);n((e=e.apply(o,t)).next())});import{B as E,a as k}from"./index.e12d43d2.js";import{B as S}from"./BasicForm.65e5c1fa.js";import{u as U}from"./useForm.7493826a.js";import{h as x,e as q,k as L}from"./System.2c591569.js";import{g as R}from"./Dept.198b3f57.js";import{aw as O,a as $,v as I,k as r,f as T,ay as w,o as j,j as z,z as N,n as V,az as G}from"./index.4ad633c8.js";const ae=[{title:"\u7528\u6237\u540D",dataIndex:"username",width:120},{title:"\u5934\u50CF",dataIndex:"avatar",width:120},{title:"\u6635\u79F0",dataIndex:"nickname",width:120},{title:"\u90AE\u7BB1",dataIndex:"email",width:120},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createdAt",width:180},{title:"\u89D2\u8272",dataIndex:"roles",width:200},{title:"\u673A\u6784",dataIndex:"depts",width:200},{title:"\u6700\u540E\u767B\u5F55\u65F6\u95F4",dataIndex:"lastLoginAt"}],ue=[{field:"id",label:"ID",component:"Input",colProps:{span:8}},{field:"nickname",label:"\u6635\u79F0",component:"Input",colProps:{span:8}},{field:"createdAt",component:"RangePicker",label:"\u521B\u5EFA\u65E5\u671F",colProps:{span:8}}],W=[{field:"id",label:"ID",component:"InputNumber",dynamicDisabled:!0},{field:"username",label:"\u7528\u6237\u540D",component:"Input",helpMessage:["\u672C\u5B57\u6BB5\u6F14\u793A\u5F02\u6B65\u9A8C\u8BC1","\u4E0D\u80FD\u8F93\u5165\u5E26\u6709admin\u7684\u7528\u6237\u540D"],rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"}]},{field:"password",label:"\u5BC6\u7801",component:"InputPassword",required:!0,ifShow:!0},{label:"\u89D2\u8272",field:"roleIds",component:"ApiSelect",componentProps:{mode:"multiple",api:x,labelField:"nameZh",valueField:"id"},required:!0},{field:"deptIds",label:"\u6240\u5C5E\u90E8\u95E8",component:"TreeSelect",componentProps:{multiple:!0,fieldNames:{label:"name",key:"id",value:"id"},getPopupContainer:()=>document.body},required:!0},{field:"nickname",label:"\u6635\u79F0",component:"Input",required:!0},{label:"\u90AE\u7BB1",field:"email",component:"Input",required:!0}],Z=$({name:"AccountModal",components:{BasicModal:E,BasicForm:S},emits:["success","register"],setup(o,{emit:t}){const e=I(!0),l=I(""),[i,{setFieldsValue:p,updateSchema:d,resetFields:n,validate:u}]=U({labelWidth:100,baseColProps:{span:24},schemas:W,showActionButtonGroup:!1,actionColOptions:{span:23}}),[c,{setModalProps:f,closeModal:h}]=k(a=>g(this,null,function*(){n(),f({confirmLoading:!1}),e.value=!!(a!=null&&a.isUpdate),r(e)&&(l.value=a.record.id,p(m({},a.record)));const D=yield R({});d([{field:"pwd",show:!r(e)},{field:"deptIds",componentProps:{treeData:D}}])})),v=T(()=>r(e)?"\u7F16\u8F91\u8D26\u53F7":"\u65B0\u589E\u8D26\u53F7");function A(){return g(this,null,function*(){try{const a=yield u();f({confirmLoading:!0}),r(e)?q(a).then(s=>{}).catch(s=>{}).finally(()=>{h(),t("success",{isUpdate:r(e),values:F(m({},a),{id:l.value})})}):L(a).then(s=>{}).catch(s=>{}).finally(()=>{h(),t("success",{isUpdate:r(e),values:F(m({},a),{id:l.value})})})}finally{f({confirmLoading:!1})}})}return{registerModal:c,registerForm:i,getTitle:v,handleSubmit:A}}});function H(o,t,e,l,i,p){const d=w("BasicForm"),n=w("BasicModal");return j(),z(n,G(o.$attrs,{onRegister:o.registerModal,title:o.getTitle,onOk:o.handleSubmit}),{default:N(()=>[V(d,{onRegister:o.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}var J=O(Z,[["render",H]]),se=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));export{J as A,se as U,ae as c,ue as s};
