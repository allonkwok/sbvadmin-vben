var v=(t,p,u)=>new Promise((d,l)=>{var _=e=>{try{n(u.next(e))}catch(o){l(o)}},m=e=>{try{n(u.throw(e))}catch(o){l(o)}},n=e=>e.done?d(e.value):Promise.resolve(e.value).then(_,m);n((u=u.apply(t,p)).next())});import{aw as b,a as w,cD as I,C as D,s as E,N as S,fA as k,f as B,ay as i,o as C,j as F,z as a,n as r,B as f,h as U,F as T,aB as R,t as N,i as V,E as $}from"./index.4ad633c8.js";import{T as x}from"./index.9593ccac.js";/* empty css              */import{D as M}from"./index.ee361b1f.js";import{B as j}from"./BasicForm.65e5c1fa.js";import{u as z}from"./useForm.7493826a.js";import{a as G}from"./index.f8983837.js";import{h as L}from"./header.d801b988.js";import{b as P}from"./data.5adb4b62.js";import{u as W}from"./upload.2714ec21.js";import{e as A}from"./System.2c591569.js";import{R as Z,C as q}from"./index.ae6cbd88.js";/* empty css              */import"./index.3cc4bdcd.js";import"./Checkbox.a821fd3b.js";import"./index.0d55e67e.js";import"./index.3af6685b.js";import"./index.ec508b52.js";import"./index.8a4a8e76.js";import"./get.d23a6385.js";import"./index.6e59dfda.js";import"./eagerComputed.39efc112.js";import"./index.96cf4f3f.js";import"./_baseIteratee.c4bc7574.js";import"./DeleteOutlined.3c5003db.js";import"./index.ed336f06.js";import"./useRefs.33304b10.js";import"./Form.1dd3fdc6.js";import"./Col.800feb1a.js";import"./useFlexGapSupport.221af0d9.js";import"./useSize.4cbf3b62.js";import"./transButton.fadc548c.js";import"./index.dd7b1cb6.js";import"./index.e12d43d2.js";import"./useWindowSizeFn.355c37f0.js";import"./FullscreenOutlined.36fb76e2.js";import"./index.3d34d703.js";import"./index.869804c4.js";import"./uuid.2b29000c.js";import"./download.a1a9703f.js";import"./base64Conver.08b9f4ec.js";import"./index.74fb7fff.js";import"./uniqBy.1ec4c51f.js";import"./index.f56e4d49.js";import"./index.671bbb03.js";const H=w({components:{Tag:x,BasicForm:j,CollapseContainer:I,Button:D,ARow:Z,ACol:q,CropperAvatar:G,Divider:M},setup(){const{createMessage:t}=$(),p=E(),[u,{setFieldsValue:d,validate:l}]=z({labelWidth:120,schemas:P,showActionButtonGroup:!1});S(()=>v(this,null,function*(){const o=yield k();d(o)}));const _=B(()=>{const{avatar:o}=p.getUserInfo;return o||L}),m=B(()=>{const{roles:o}=p.getUserInfo;return o||[]});function n({source:o,data:s}){const c=p.getUserInfo;c.avatar=o,p.setUserInfo(c);const g={id:c.userId,avatar:s.result};A(g).then(()=>{t.success("\u4FEE\u6539\u6210\u529F!")}).catch(()=>{t.error("3")}).finally(()=>{})}function e(){return v(this,null,function*(){const o=yield l();A(o).then(s=>{t.success(s)}).catch(()=>{t.error("3")}).finally(()=>{})})}return{avatar:_,roles:m,register:u,uploadApi:W,updateAvatar:n,handleSubmit:e}}}),J={class:"change-avatar"};function K(t,p,u,d,l,_){const m=i("BasicForm"),n=i("a-col"),e=i("Divider"),o=i("Tag"),s=i("a-row"),c=i("CropperAvatar"),g=i("Button"),y=i("CollapseContainer");return C(),F(y,{title:"\u57FA\u672C\u8BBE\u7F6E",canExpan:!1},{default:a(()=>[r(s,{gutter:24},{default:a(()=>[r(n,{span:14},{default:a(()=>[r(m,{onRegister:t.register},null,8,["onRegister"])]),_:1}),r(n,{span:10},{default:a(()=>[r(e,null,{default:a(()=>[f("\u8D26\u53F7\u89D2\u8272")]),_:1}),r(s,{gutter:24},{default:a(()=>[(C(!0),U(T,null,R(t.roles,h=>(C(),F(o,{key:h.value,color:"green"},{default:a(()=>[f(N(h.nameZh),1)]),_:2},1024))),128))]),_:1}),r(e,null,{default:a(()=>[f("\u5934\u50CF")]),_:1}),r(s,{gutter:24},{default:a(()=>[V("div",J,[r(c,{uploadApi:t.uploadApi,value:t.avatar,btnText:"\u66F4\u6362\u5934\u50CF",btnProps:{preIcon:"ant-design:cloud-upload-outlined"},onChange:t.updateAvatar,width:"150"},null,8,["uploadApi","value","onChange"])])]),_:1})]),_:1})]),_:1}),r(g,{type:"primary",onClick:t.handleSubmit},{default:a(()=>[f(" \u66F4\u65B0\u57FA\u672C\u4FE1\u606F ")]),_:1},8,["onClick"])]),_:1})}var Po=b(H,[["render",K],["__scopeId","data-v-941958e6"]]);export{Po as default};
